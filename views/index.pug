extends layout

block headContent
	title Home
	
block content
	h1.h3 #{coinConfig.siteTitle}
	hr

	if (getblockchaininfo == null)
		div(class="alert alert-warning")
			p(class="font-weight-bold") Unable to get basic blockchain data
			ul
				li If you just started your node, it may still be initializing.
				li If your node is already initialized, check your RPC connection info.
	else

		- var networkSummaryItemCount = 4;

		if (getblockchaininfo.size_on_disk)
			- networkSummaryItemCount++;

		if (global.exchangeRates)
			- networkSummaryItemCount++;

		if (txStats)
			- networkSummaryItemCount++;

		- var networkSummaryColumnClass = "col-md-4";
		if (networkSummaryItemCount > 6)
			- networkSummaryColumnClass = "col-md-3";
			
		div(class="card mb-4 shadow-sm")
			div(class="card-header")
				h2(class="h6 mb-0") Network Summary
			div(class="card-body")
				div(class="row")
					div(class=networkSummaryColumnClass)
						div(class="float-left", style="height: 40px; width: 40px; font-size: 12px;")
							span
								i(class="fas fa-globe fa-2x mr-2", style="margin-top: 6px;")

						span(class="font-weight-bold") Last Indexed Block

						p(class="lead")
							span #{getblockchaininfo.blocks.toLocaleString()}

					div(class=networkSummaryColumnClass)
						div(class="float-left", style="height: 40px; width: 40px; font-size: 12px;")
							span
								i(class="fas fa-hashtag fa-2x mr-2", style="margin-top: 6px;")

						span(class="font-weight-bold") Best Block Hash

						p(class="lead")
							div(class="text-overflow-ellipsis" data-toggle="tooltip", title=getblockchaininfo.bestblockhash) #{getblockchaininfo.bestblockhash}

					div(class=networkSummaryColumnClass)
						div(class="float-left", style="height: 40px; width: 40px;")
							span
								i(class="fas fa-tachometer-alt fa-2x mr-2", style="margin-top: 6px;")
						- var hashrateData = utils.formatLargeNumber(miningInfo.networkhashps, 3);
						
						span(class="font-weight-bold") Hashrate

						p(class="lead")
							span #{hashrateData[0]}

					div(class=networkSummaryColumnClass)
						div(class="float-left", style="height: 40px; width: 40px; font-size: 12px;")
							span
								i(class="fas fa-dumbbell fa-2x mr-2", style="margin-top: 6px;")

						- var difficultyData = getblockchaininfo.difficulty_pos;

						span(class="font-weight-bold") PoS Difficulty

						p(class="lead")
							span #{difficultyData}

					div(class=networkSummaryColumnClass)
						div(class="float-left", style="height: 40px; width: 40px; font-size: 12px;")
							span
								i(class="fas fa-dumbbell fa-2x mr-2", style="margin-top: 6px;")

						- var difficultyDataPoW = getblockchaininfo.difficulty_pow;

						span(class="font-weight-bold") PoW Difficulty

						p(class="lead")
							span #{difficultyDataPoW}

					div(class=networkSummaryColumnClass)
						div(class="float-left", style="height: 40px; width: 40px;")
							span
								i(class="fas fa-unlock-alt fa-2x mr-2", style="margin-top: 6px; margin-left: 3px;")

						span(class="font-weight-bold") Unconfirmed Transactions

						p(class="lead") #{mempoolInfo.size.toLocaleString()} tx 
							- var mempoolBytesData = utils.formatLargeNumber(mempoolInfo.usage, 2);
							small(class="text-muted font-weight-light") (#{mempoolBytesData[0]} #{mempoolBytesData[1].abbreviation}B)

					div(class=networkSummaryColumnClass)
						div(class="float-left", style="height: 40px; width: 40px;")
							span
								i(class="fas fa-bolt fa-2x mr-2", style="margin-top: 6px; margin-left: 6px;")

						- var chainworkData = utils.formatLargeNumber(parseInt("0x" + getblockchaininfo.chainwork), 2);
						span(class="font-weight-bold") Chainwork
						
						p(class="lead")
							span.mr-2.border-dotted(data-toggle="tooltip", title=getblockchaininfo.chainwork.replace(/^0+/, ''))
								span #{chainworkData[0]}
								span  x 10
								sup #{chainworkData[1].exponent}
								span  hashes

					if (getblockchaininfo.size_on_disk)
						div(class=networkSummaryColumnClass)
							div(class="float-left", style="height: 40px; width: 40px;")
								span
									i(class="fas fa-database fa-2x mr-2", style="margin-top: 6px; margin-left: 3px;")
							span(class="font-weight-bold") Blockchain Size

							- var sizeData = utils.formatLargeNumber(getblockchaininfo.size_on_disk, 2);
							p(class="lead") #{sizeData[0]} #{sizeData[1].abbreviation}B 
		
					- var oBlockTypeStats = getBlockTypeStatsByStartHeight((getblockchaininfo.blocks - 1440);
					if (oBlockTypeStats) == null)
						div(class=networkSummaryColumnClass)
							div(class="float-left", style="height: 40px; width: 40px; font-size: 12px;")
								span
									i(class="fas fa-dumbbell fa-2x mr-2", style="margin-top: 6px;")

							span(class="font-weight-bold") PoS

							p(class="lead")
								span #{oBlockTypeStats.PosCount}
								<br>
								span #{oBlockTypeStats.PosDiff}
								<br> 
								span #{oBlockTypeStats.PosPercent}%

						div(class=networkSummaryColumnClass)
							div(class="float-left", style="height: 40px; width: 40px; font-size: 12px;")
								span
									i(class="fas fa-dumbbell fa-2x mr-2", style="margin-top: 6px;")

							span(class="font-weight-bold") ProgPow

							p(class="lead")
								span #{oBlockTypeStats.ProgPowCount}
								<br>
								span #{oBlockTypeStats.ProgPowDiff}
								<br> 
								span #{oBlockTypeStats.ProgPowPercent}%

						div(class=networkSummaryColumnClass)
							div(class="float-left", style="height: 40px; width: 40px; font-size: 12px;")
								span
									i(class="fas fa-dumbbell fa-2x mr-2", style="margin-top: 6px;")

							span(class="font-weight-bold") RandomX

							p(class="lead")
								span #{oBlockTypeStats.RandomxCount}
								<br>
								span #{oBlockTypeStats.RandomxDiff}								
								<br> 
								span #{oBlockTypeStats.RandomxPercent}%

						div(class=networkSummaryColumnClass)
							div(class="float-left", style="height: 40px; width: 40px; font-size: 12px;")
								span
									i(class="fas fa-dumbbell fa-2x mr-2", style="margin-top: 6px;")

							span(class="font-weight-bold") SHA256D

							p(class="lead")
								span #{oBlockTypeStats.Sha256dCount}
								<br>
								span #{oBlockTypeStats.Sha256dDiff}
								<br> 
								span #{oBlockTypeStats.Sha256dPercent}%

		include includes/tools-card.pug
		
		if (latestBlocks)
			div(class="card mb-4 shadow-sm")
				div(class="card-header")
					div(class="row")
						div(class="col")
							h2(class="h6 mb-0") Latest Blocks
								if (getblockchaininfo.initialblockdownload)
									small  (#{(getblockchaininfo.headers - getblockchaininfo.blocks).toLocaleString()} behind)

						div(class="col")
							span(style="float: right;")
								a(href="/blocks")
									span  Browse Blocks &raquo;

				div(class="card-body")

					- var blocks = latestBlocks;
					- var blockOffset = 0;

					include includes/blocks-list.pug


		if (txStats)
			div(class="card mb-4 shadow-sm")
				div(class="card-header")
					div(class="row")
						div(class="col")
							h2(class="h6 mb-0") Transaction Stats Summary

						div(class="col")
							span(style="float: right;")
								a(href="/tx-stats")
									span  Transaction Stats &raquo;
			
				div(class="card-body")
					if (true)
						div(class="row")
							div(class="col-lg-6")
								div(class="table-responsive")
									table(class="table text-right mb-4 mb-lg-0")
										thead
											tr
												th Period
												th Transactions
												th Transactions Per Sec
										tbody
											each item, index in chainTxStats
												tr(class="monospace")
													td #{chainTxStatsLabels[index]}
													td #{item.window_tx_count.toLocaleString()}
													td #{new Decimal(item.txrate).toDecimalPlaces(4)}


							div(class="col-lg-6")
								script var txRateDataDay = [];
								each item, index in txStats.txCountStats.txRates
									script txRateDataDay.push({x:#{item.x}, y:#{item.y}});

								- var graphData = {id:"graphRateDay", dataVar:"txRateDataDay", labels:txStats.txCountStats.txLabels, title:"Tx Rate, 24hr", xaxisTitle:"Block", xaxisStep:5, yaxisTitle:"Tx Per Sec"};
								include ./includes/line-graph.pug
											